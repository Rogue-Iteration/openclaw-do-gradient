permissions:
  # Read-only shared libraries
  - path: /etc/s6-overlay/lib
    mode: "0555"
  - path: /etc/s6-overlay/lib/*
    mode: "0444"

  # Read-only digitalocean config files
  - path: /etc/digitalocean
    mode: "0555"
  - path: /etc/digitalocean/*
    mode: "0444"

  # s6 container environment - base directory must be traversable
  - path: /run/s6/container_environment
    mode: "0755"

  # s6 container environment files - root only for sensitive data
  - path: /run/s6/container_environment/**/*
    user: root
    group: root
    mode: "0600"

  # OPENCLAW_ env directory and files readable by openclaw service
  - path: /run/s6/container_environment/OPENCLAW_
    user: openclaw
    group: openclaw
    mode: "0755"
  - path: /run/s6/container_environment/OPENCLAW_/*
    user: openclaw
    group: openclaw
    mode: "0644"

  # OpenClaw state directory
  - path: /data/.openclaw
    user: openclaw
    group: openclaw
    mode: "0700"
  - path: /data/.openclaw/**
    user: openclaw
    group: openclaw
  - path: /data/.openclaw/openclaw.json
    user: openclaw
    group: openclaw
    mode: "0600"

  # Cron directories and files
  - path: /etc/cron.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/cron.d/*
    user: root
    group: root
    mode: "0644"

  # s6-overlay directories and scripts
  - path: /etc/cont-init.d
    user: root
    group: root
    mode: "0755"
  - path: /etc/cont-init.d/*
    user: root
    group: root
    mode: "0755"
  - path: /etc/services.d
    user: root
    group: root
    mode: "0755"
